(function(){var adventiveClickTrackURL='';parent.postMessage('getClickTrackerUrl','*');var links=document.getElementsByTagName('a');for(var i=0;i<links.length;i++){if(links[i].onclick===null){if(validateUrl(links[i].href)){if(document.addEventListener){links[i].addEventListener('click',adventive_click_callback,false);}else{links[i].attachEvent('onclick',adventive_click_callback);}}}}
try{var eventMethod=window.addEventListener?'addEventListener':'attachEvent';var eventer=window[eventMethod];var messageEvent=eventMethod=='attachEvent'?'onmessage':'message';eventer(messageEvent,function(e){var key=e.message?'message':'data';var data=e[key];if(typeof data==='object'){if(data.method==='setClickTracker'){if(validateUrl(data.ext_track)){adventiveClickTrackURL=data.ext_track;}}}},false);}catch(e){console.log('messaging API not supported');}
function adventive_click_callback(e){e=window.e||e;if(e.target.tagName!=='A')return;if(validateUrl(e.target.href)){window.open(e.target.href,'_blank');e.stopImmediatePropagation();e.preventDefault();e.stopPropagation();return false;}}
function validateUrl(url){var valid=/^(ftp|http|https):\/\/[^ "]+$/.test(url);return valid;}
var open_=window.open;window.open=function(url,name,opts){if(validateUrl(url)){var data={'method':'log_clickthrough','href':url};parent.postMessage(data,'*');if(validateUrl(adventiveClickTrackURL)){url=adventiveClickTrackURL+encodeURIComponent(url);}}
if(typeof name==='undefined')name='_blank';return open_(url,name);};})();